<!DOCTYPE html>
<html lang="ja" data-theme="auto">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' 'unsafe-inline' https://cdn.jsdelivr.net; style-src 'self' 'unsafe-inline' https://cdn.jsdelivr.net; img-src 'self' data: https:; connect-src 'self'; font-src 'self' https://cdn.jsdelivr.net; object-src 'none'; media-src 'self'; frame-src 'none';">
    <meta http-equiv="X-Content-Type-Options" content="nosniff">
    <meta http-equiv="X-Frame-Options" content="DENY">
    <meta http-equiv="X-XSS-Protection" content="1; mode=block">
    <meta http-equiv="Referrer-Policy" content="strict-origin-when-cross-origin">
    <title>Market News Dashboard - AIãƒ‹ãƒ¥ãƒ¼ã‚¹åˆ†æ</title>
    
    <!-- Meta Tags -->
    <meta name="description" content="AIãŒä¸»è¦ãƒ‹ãƒ¥ãƒ¼ã‚¹ã‚µã‚¤ãƒˆã‹ã‚‰åé›†ãƒ»è¦ç´„ã—ãŸæœ€æ–°ã®å¸‚å ´ãƒ‹ãƒ¥ãƒ¼ã‚¹">
    <meta name="keywords" content="ãƒ‹ãƒ¥ãƒ¼ã‚¹,å¸‚å ´,AI,è¦ç´„,æ ªå¼,çµŒæ¸ˆ">
    <meta name="author" content="Market News AI">
    
    <!-- Open Graph -->
    <meta property="og:title" content="Market News Dashboard - AIãƒ‹ãƒ¥ãƒ¼ã‚¹åˆ†æ">
    <meta property="og:description" content="AIãŒåˆ†æã—ãŸæœ€æ–°ãƒãƒ¼ã‚±ãƒƒãƒˆãƒ‹ãƒ¥ãƒ¼ã‚¹">
    <meta property="og:type" content="website">
    
    <!-- CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@picocss/pico@2.0.6/css/pico.min.css">
    <link rel="stylesheet" href="assets/css/custom.css">
    
    <!-- Chart.jså‰Šé™¤ - SVGå®Ÿè£…ã®ãŸã‚ä¸è¦ -->
    
    <!-- PWA -->
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#1976d2">
    
    <!-- Icons -->
    <link rel="icon" type="image/x-icon" href="favicon.ico">
</head>
<body>
    
    <!-- Header -->
    <header class="container main-header">
        <div class="header-content">
            <h1 class="header-title">
                ğŸ“Š Market News Dashboard
            </h1>
            <div class="header-controls">
                <button id="theme-toggle" class="theme-toggle" aria-label="ãƒ†ãƒ¼ãƒåˆ‡ã‚Šæ›¿ãˆ">ğŸŒ™</button>
                <button id="refresh-button" class="refresh-button">ğŸ”„ æ›´æ–°</button>
                <a href="preview/" class="pro-summary-link" id="social-preview-link">ğŸ¨ SNSãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼</a>
                <a href="pro-summary.html" class="pro-summary-link">ğŸ“ˆ è©³ç´°åˆ†æ</a>
            </div>
        </div>
        <p>AIãŒä¸»è¦ãƒ‹ãƒ¥ãƒ¼ã‚¹ã‚µã‚¤ãƒˆã‹ã‚‰åé›†ãƒ»è¦ç´„ã—ãŸæœ€æ–°æƒ…å ±</p>
    </header>
    
    <main class="container">
        
        <!-- çµ±è¨ˆã‚»ã‚¯ã‚·ãƒ§ãƒ³ -->
        <section class="stats-section">
            <div class="grid">
                <div class="stat-card info-card">
                    <div class="info-row">
                        <div class="stat-number" id="total-articles">-</div>
                        <div class="stat-label">ç·è¨˜äº‹æ•°</div>
                    </div>
                    <div class="info-row">
                        <div class="stat-number" id="last-updated">-</div>
                        <div class="stat-label">æœ€çµ‚æ›´æ–°</div>
                    </div>
                </div>
                <div class="stat-card chart-card">
                    <button class="expand-btn" onclick="openChartModal('region')">â¤¢ æ‹¡å¤§</button>
                    <div class="chart-container">
                        <div id="region-chart" class="svg-chart"></div>
                    </div>
                    <div id="region-legend" class="chart-legend" aria-label="åœ°åŸŸåˆ†å¸ƒã®å‡¡ä¾‹"></div>
                    <div class="stat-label">åœ°åŸŸåˆ†å¸ƒ</div>
                    <div class="chart-summary">
                        <div class="chart-summary-title">Top3åœ°åŸŸ</div>
                        <p class="chart-summary-text" id="region-summary">ãƒ‡ãƒ¼ã‚¿èª­ã¿è¾¼ã¿ä¸­...</p>
                    </div>
                </div>
                <div class="stat-card chart-card">
                    <button class="expand-btn" onclick="openChartModal('category')">â¤¢ æ‹¡å¤§</button>
                    <div class="chart-container">
                        <div id="category-chart" class="svg-chart"></div>
                    </div>
                    <div id="category-legend" class="chart-legend" aria-label="ã‚«ãƒ†ã‚´ãƒªåˆ†å¸ƒã®å‡¡ä¾‹"></div>
                    <div class="stat-label">ã‚«ãƒ†ã‚´ãƒªåˆ†å¸ƒ</div>
                    <div class="chart-summary">
                        <div class="chart-summary-title">Top3ã‚«ãƒ†ã‚´ãƒª</div>
                        <p class="chart-summary-text" id="category-summary">ãƒ‡ãƒ¼ã‚¿èª­ã¿è¾¼ã¿ä¸­...</p>
                    </div>
                </div>
            </div>
        </section>
        
        <!-- ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ãƒ»æ¤œç´¢ -->
        <section class="filter-section">
            <div class="filter-row">
                <div class="filter-group">
                    <label for="search-input">ğŸ” è¨˜äº‹ã‚’æ¤œç´¢</label>
                    <input type="search" id="search-input" placeholder="ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã§æ¤œç´¢... (Ctrl+K)">
                </div>
                <div class="filter-group">
                    <label for="source-filter">ğŸ“° ã‚½ãƒ¼ã‚¹</label>
                    <select id="source-filter">
                        <option value="">å…¨ã¦ã®ã‚½ãƒ¼ã‚¹</option>
                        <option value="Reuters">Reuters</option>
                        <option value="Bloomberg">Bloomberg</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label for="region-filter">ğŸŒ åœ°åŸŸ</label>
                    <select id="region-filter">
                        <option value="">å…¨ã¦ã®åœ°åŸŸ</option>
                        <option value="japan">æ—¥æœ¬</option>
                        <option value="usa">ã‚¢ãƒ¡ãƒªã‚«</option>
                        <option value="europe">æ¬§å·</option>
                        <option value="asia">ã‚¢ã‚¸ã‚¢</option>
                        <option value="global">ã‚°ãƒ­ãƒ¼ãƒãƒ«</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label for="sort-filter">ğŸ“Š ä¸¦ã³é †</label>
                    <select id="sort-filter">
                        <option value="date-desc">æ—¥æ™‚ï¼ˆæ–°ã—ã„é †ï¼‰</option>
                        <option value="date-asc">æ—¥æ™‚ï¼ˆå¤ã„é †ï¼‰</option>
                        <option value="source">ã‚½ãƒ¼ã‚¹é †</option>
                    </select>
                </div>
            </div>
        </section>
        
        <!-- Loading Indicator -->
        <div id="loading" style="text-align: center; padding: 2rem; display: block;">
            <div style="font-size: 2rem;">â³</div>
            <p>è¨˜äº‹ã‚’èª­ã¿è¾¼ã¿ä¸­...</p>
        </div>
        
        <!-- è¨˜äº‹ä¸€è¦§ -->
        <section id="articles-section" style="display: none;">
            <h2>ğŸ“° è¨˜äº‹ä¸€è¦§ <span id="articles-count"></span></h2>
            <div id="articles-container" class="articles-grid">
                <!-- è¨˜äº‹ã¯JavaScriptã§å‹•çš„ã«ç”Ÿæˆ -->
            </div>
        </section>
    </main>
    
    <!-- Footer -->
    <footer class="footer">
        <div class="footer-content">
            <div class="footer-section">
                <h4>Market News Dashboard</h4>
                <p>AIã«ã‚ˆã‚‹å¸‚å ´ãƒ‹ãƒ¥ãƒ¼ã‚¹åˆ†æ</p>
            </div>
            <div class="footer-section">
                <h4>æœ€çµ‚æ›´æ–°</h4>
                <p id="footer-last-updated">-</p>
            </div>
            <div class="footer-section">
                <h4>ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹</h4>
                <p>Reuters, Bloomberg</p>
            </div>
        </div>
        <hr>
        <div style="text-align: center;">
            <small>Powered by Gemini AI & Python Scrapers | ğŸ¤– Generated with Claude Code</small>
        </div>
    </footer>
    
    <!-- ãƒ¢ãƒ¼ãƒ€ãƒ«æ‹¡å¤§ãƒ“ãƒ¥ãƒ¼ -->
    <div id="chart-modal" class="chart-modal" onclick="closeChartModal()">
        <div class="chart-modal-content" onclick="event.stopPropagation()">
            <div class="chart-modal-header">
                <h2 id="modal-title">ã‚°ãƒ©ãƒ•è©³ç´°è¡¨ç¤º</h2>
                <button class="modal-close" onclick="closeChartModal()">Ã—</button>
            </div>
            <div class="chart-modal-body">
                <div id="modal-chart-container" class="modal-chart-container">
                    <div id="modal-chart" class="svg-chart"></div>
                </div>
                <div id="modal-legend" class="chart-legend"></div>
                <div id="modal-summary" class="chart-summary"></div>
            </div>
        </div>
    </div>
    
    <!-- JavaScript -->
    <script>
        // Safari å¯¾å¿œã®ãŸã‚ã® Polyfill
        if (!Array.prototype.includes) {
            Array.prototype.includes = function(searchElement /*, fromIndex*/) {
                'use strict';
                var O = Object(this);
                var len = parseInt(O.length) || 0;
                if (len === 0) {
                    return false;
                }
                var n = parseInt(arguments[1]) || 0;
                var k;
                if (n >= 0) {
                    k = n;
                } else {
                    k = len + n;
                    if (k < 0) {k = 0;}
                }
                for (; k < len; k++) {
                    if (searchElement === O[k]) {
                        return true;
                    }
                }
                return false;
            };
        }

        // app.jsã¨ã®é€£æºã®ãŸã‚ã®ã‚°ãƒ­ãƒ¼ãƒãƒ«é–¢æ•°
        window.clearFilters = () => {
            if (window.app) {
                window.app.clearFilters();
            }
        };
    </script>
    
    <!-- Data Loading Script for Chart Rendering -->
    <script>
        // Load articles data for chart generation
        async function loadArticlesData() {
            try {
                const response = await fetch('data/articles.json');
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                const data = await response.json();
                window.articlesData = data;
                console.log('âœ… Articles data loaded successfully:', data.length, 'articles');
                
                // ãƒ‡ãƒ¼ã‚¿èª­ã¿è¾¼ã¿å¾Œã«app.jsã‚’èª­ã¿è¾¼ã¿
                const script = document.createElement('script');
                script.src = 'assets/js/app.js?v=20250828-ultra';
                document.body.appendChild(script);
            } catch (error) {
                console.error('âŒ Failed to load articles data:', error);
                window.articlesData = [];
                
                // ã‚¨ãƒ©ãƒ¼æ™‚ã§ã‚‚app.jsã‚’èª­ã¿è¾¼ã¿ï¼ˆç©ºã®ãƒ‡ãƒ¼ã‚¿ã§å‹•ä½œã•ã›ã‚‹ï¼‰
                const script = document.createElement('script');
                script.src = 'assets/js/app.js?v=20250828-ultra';
                document.body.appendChild(script);
            }
        }
        
        // Load data before initializing the app
        loadArticlesData();
        
        // SNSãƒ—ãƒ¬ãƒ“ãƒ¥ãƒ¼ãƒªãƒ³ã‚¯ã¯å¸¸æ™‚è¡¨ç¤ºï¼ˆå‹•çš„ãƒã‚§ãƒƒã‚¯ä¸è¦ï¼‰
    </script>
</body>
</html>
