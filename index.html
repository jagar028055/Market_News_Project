<!DOCTYPE html>
<html lang="ja" data-theme="auto">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <title>Market News Dashboard - AIãƒ‹ãƒ¥ãƒ¼ã‚¹åˆ†æ</title>
    
    <!-- Meta Tags -->
    <meta name="description" content="AIãŒä¸»è¦ãƒ‹ãƒ¥ãƒ¼ã‚¹ã‚µã‚¤ãƒˆã‹ã‚‰åé›†ãƒ»è¦ç´„ã—ãŸæœ€æ–°ã®å¸‚å ´ãƒ‹ãƒ¥ãƒ¼ã‚¹">
    <meta name="keywords" content="ãƒ‹ãƒ¥ãƒ¼ã‚¹,å¸‚å ´,AI,è¦ç´„,æ ªå¼,çµŒæ¸ˆ">
    <meta name="author" content="Market News AI">
    
    <!-- Open Graph -->
    <meta property="og:title" content="Market News Dashboard - AIãƒ‹ãƒ¥ãƒ¼ã‚¹åˆ†æ">
    <meta property="og:description" content="AIãŒåˆ†æã—ãŸæœ€æ–°ãƒãƒ¼ã‚±ãƒƒãƒˆãƒ‹ãƒ¥ãƒ¼ã‚¹">
    <meta property="og:type" content="website">
    
    <!-- CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@picocss/pico@2.0.6/css/pico.min.css">
    <link rel="stylesheet" href="assets/css/custom.css">
    
    <!-- PWA -->
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#1976d2">
    
    <!-- Icons -->
    <link rel="icon" type="image/x-icon" href="favicon.ico">
</head>
<body>
    
    <!-- Header -->
    <header class="container main-header">
        <div class="header-content">
            <h1 class="header-title">
                ğŸ“Š Market News Dashboard
            </h1>
            <div class="header-controls">
                <button id="theme-toggle" class="theme-toggle" aria-label="ãƒ†ãƒ¼ãƒåˆ‡ã‚Šæ›¿ãˆ">ğŸŒ™</button>
                <button id="refresh-button" class="refresh-button">ğŸ”„ æ›´æ–°</button>
                <a href="pro-summary.html" class="pro-summary-link">ğŸ“ˆ è©³ç´°åˆ†æ</a>
            </div>
        </div>
        <p>AIãŒä¸»è¦ãƒ‹ãƒ¥ãƒ¼ã‚¹ã‚µã‚¤ãƒˆã‹ã‚‰åé›†ãƒ»è¦ç´„ã—ãŸæœ€æ–°æƒ…å ±</p>
    </header>
    
    <main class="container">
        
        <!-- çµ±è¨ˆã‚»ã‚¯ã‚·ãƒ§ãƒ³ -->
        <section class="stats-section">
            <div class="grid">
                <div class="stat-card">
                    <div class="stat-number" id="total-articles">-</div>
                    <div class="stat-label">ç·è¨˜äº‹æ•°</div>
                </div>
                <div class="stat-card">
                    <div class="stat-number" id="last-updated">-</div>
                    <div class="stat-label">æœ€çµ‚æ›´æ–°</div>
                </div>
                <div class="stat-card">
                    <div id="region-chart"></div>
                    <div class="stat-label">åœ°åŸŸåˆ†å¸ƒ</div>
                </div>
                <div class="stat-card">
                    <div id="category-chart"></div>
                    <div class="stat-label">ã‚«ãƒ†ã‚´ãƒªåˆ†å¸ƒ</div>
                </div>
            </div>
        </section>
        
        <!-- ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼ãƒ»æ¤œç´¢ -->
        <section class="filter-section">
            <div class="filter-row">
                <div class="filter-group">
                    <label for="search-input">ğŸ” è¨˜äº‹ã‚’æ¤œç´¢</label>
                    <input type="search" id="search-input" placeholder="ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã§æ¤œç´¢... (Ctrl+K)">
                </div>
                <div class="filter-group">
                    <label for="source-filter">ğŸ“° ã‚½ãƒ¼ã‚¹</label>
                    <select id="source-filter">
                        <option value="">å…¨ã¦ã®ã‚½ãƒ¼ã‚¹</option>
                        <option value="Reuters">Reuters</option>
                        <option value="Bloomberg">Bloomberg</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label for="region-filter">ğŸŒ åœ°åŸŸ</label>
                    <select id="region-filter">
                        <option value="">å…¨ã¦ã®åœ°åŸŸ</option>
                        <option value="japan">æ—¥æœ¬</option>
                        <option value="usa">ã‚¢ãƒ¡ãƒªã‚«</option>
                        <option value="europe">æ¬§å·</option>
                        <option value="asia">ã‚¢ã‚¸ã‚¢</option>
                        <option value="global">ã‚°ãƒ­ãƒ¼ãƒãƒ«</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label for="sort-filter">ğŸ“Š ä¸¦ã³é †</label>
                    <select id="sort-filter">
                        <option value="date-desc">æ—¥æ™‚ï¼ˆæ–°ã—ã„é †ï¼‰</option>
                        <option value="date-asc">æ—¥æ™‚ï¼ˆå¤ã„é †ï¼‰</option>
                        <option value="source">ã‚½ãƒ¼ã‚¹é †</option>
                    </select>
                </div>
            </div>
        </section>
        
        <!-- Loading Indicator -->
        <div id="loading" style="text-align: center; padding: 2rem; display: block;">
            <div style="font-size: 2rem;">â³</div>
            <p>è¨˜äº‹ã‚’èª­ã¿è¾¼ã¿ä¸­...</p>
        </div>
        
        <!-- è¨˜äº‹ä¸€è¦§ -->
        <section id="articles-section" style="display: none;">
            <h2>ğŸ“° è¨˜äº‹ä¸€è¦§ <span id="articles-count"></span></h2>
            <div id="articles-container" class="articles-grid">
                <!-- è¨˜äº‹ã¯JavaScriptã§å‹•çš„ã«ç”Ÿæˆ -->
            </div>
        </section>
    </main>
    
    <!-- Footer -->
    <footer class="footer">
        <div class="footer-content">
            <div class="footer-section">
                <h4>Market News Dashboard</h4>
                <p>AIã«ã‚ˆã‚‹å¸‚å ´ãƒ‹ãƒ¥ãƒ¼ã‚¹åˆ†æ</p>
            </div>
            <div class="footer-section">
                <h4>æœ€çµ‚æ›´æ–°</h4>
                <p id="footer-last-updated">-</p>
            </div>
            <div class="footer-section">
                <h4>ãƒ‡ãƒ¼ã‚¿ã‚½ãƒ¼ã‚¹</h4>
                <p>Reuters, Bloomberg</p>
            </div>
        </div>
        <hr>
        <div style="text-align: center;">
            <small>Powered by Gemini AI & Python Scrapers | ğŸ¤– Generated with Claude Code</small>
        </div>
    </footer>
    
    <!-- JavaScript -->
    <script>
        // ã‚°ãƒ­ãƒ¼ãƒãƒ«å¤‰æ•°
        let articlesData = [];
        let filteredArticles = [];
        
        // JSONãƒ•ã‚¡ã‚¤ãƒ«ã‹ã‚‰è¨˜äº‹ãƒ‡ãƒ¼ã‚¿ã‚’èª­ã¿è¾¼ã¿
        async function loadArticlesData() {
            try {
                const response = await fetch('data/articles.json');
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                const data = await response.json();
                
                // æ„Ÿæƒ…åˆ†æãƒ‡ãƒ¼ã‚¿ã‚’å‰Šé™¤ï¼ˆFlashè¦ç´„ã®ã¿è¡¨ç¤ºï¼‰
                articlesData = data.map(article => ({
                    title: article.title,
                    url: article.url,
                    summary: article.summary,
                    source: article.source,
                    published_jst: article.published_jst
                }));
                
                console.log('è¨˜äº‹ãƒ‡ãƒ¼ã‚¿ã‚’èª­ã¿è¾¼ã¿ã¾ã—ãŸ:', articlesData.length + 'ä»¶');
                
                // ãƒ‡ãƒ¼ã‚¿èª­ã¿è¾¼ã¿å®Œäº†å¾Œã«åˆæœŸåŒ–
                hideLoading();
                initializeApp();
                
            } catch (error) {
                console.error('è¨˜äº‹ãƒ‡ãƒ¼ã‚¿ã®èª­ã¿è¾¼ã¿ã«å¤±æ•—ã—ã¾ã—ãŸ:', error);
                hideLoading();
                showError('è¨˜äº‹ãƒ‡ãƒ¼ã‚¿ã®èª­ã¿è¾¼ã¿ã«å¤±æ•—ã—ã¾ã—ãŸã€‚');
            }
        }
        
        // ãƒ­ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°éè¡¨ç¤º
        function hideLoading() {
            document.getElementById('loading').style.display = 'none';
            document.getElementById('articles-section').style.display = 'block';
        }
        
        // ã‚¨ãƒ©ãƒ¼è¡¨ç¤º
        function showError(message) {
            document.getElementById('articles-container').innerHTML = 
                `<div class="error-message" style="text-align: center; padding: 2rem; color: #e74c3c;">
                    <h3>âš ï¸ ã‚¨ãƒ©ãƒ¼</h3>
                    <p>${message}</p>
                </div>`;
        }
        
        // ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³åˆæœŸåŒ–
        function initializeApp() {
            updateStats();
            filteredArticles = [...articlesData];
            displayArticles();
            setupEventListeners();
        }
        
        // çµ±è¨ˆæƒ…å ±ã‚’æ›´æ–°
        function updateStats() {
            const totalArticles = articlesData.length;
            document.getElementById('total-articles').textContent = totalArticles;
            document.getElementById('articles-count').textContent = `(${totalArticles}ä»¶)`;
            
            // æœ€çµ‚æ›´æ–°æ—¥æ™‚ã‚’è¨ˆç®—
            if (articlesData.length > 0) {
                const latestDate = articlesData.reduce((latest, article) => {
                    const articleDate = new Date(article.published_jst);
                    return articleDate > latest ? articleDate : latest;
                }, new Date(articlesData[0].published_jst));
                
                const formattedDate = latestDate.toLocaleString('ja-JP', {
                    year: 'numeric',
                    month: '2-digit',
                    day: '2-digit',
                    hour: '2-digit',
                    minute: '2-digit'
                });
                
                document.getElementById('last-updated').textContent = formattedDate;
                document.getElementById('footer-last-updated').textContent = formattedDate;
            }
        }
        
        // è¨˜äº‹ã‚’è¡¨ç¤º
        function displayArticles() {
            const container = document.getElementById('articles-container');
            
            if (filteredArticles.length === 0) {
                container.innerHTML = '<div class="no-articles">è©²å½“ã™ã‚‹è¨˜äº‹ãŒè¦‹ã¤ã‹ã‚Šã¾ã›ã‚“ã§ã—ãŸã€‚</div>';
                return;
            }
            
            const articlesHTML = filteredArticles.map(article => {
                const publishedDate = new Date(article.published_jst).toLocaleString('ja-JP', {
                    year: 'numeric',
                    month: '2-digit',
                    day: '2-digit',
                    hour: '2-digit',
                    minute: '2-digit'
                });
                
                return `
                    <article class="article-card">
                        <header class="article-header">
                            <h3 class="article-title">
                                <a href="${article.url}" target="_blank" rel="noopener noreferrer">
                                    ${article.title}
                                </a>
                            </h3>
                            <div class="article-meta">
                                <span class="article-source">ğŸ“° ${article.source}</span>
                                <span class="article-date">ğŸ•’ ${publishedDate}</span>
                            </div>
                        </header>
                        <div class="article-content">
                            <p class="article-summary">${article.summary}</p>
                        </div>
                    </article>
                `;
            }).join('');
            
            container.innerHTML = articlesHTML;
            document.getElementById('articles-count').textContent = `(${filteredArticles.length}ä»¶)`;
        }
        
        // ã‚¤ãƒ™ãƒ³ãƒˆãƒªã‚¹ãƒŠãƒ¼è¨­å®š
        function setupEventListeners() {
            // æ¤œç´¢æ©Ÿèƒ½
            const searchInput = document.getElementById('search-input');
            searchInput.addEventListener('input', filterArticles);
            
            // ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼æ©Ÿèƒ½
            const sourceFilter = document.getElementById('source-filter');
            const regionFilter = document.getElementById('region-filter');
            const sortFilter = document.getElementById('sort-filter');
            
            sourceFilter.addEventListener('change', filterArticles);
            regionFilter.addEventListener('change', filterArticles);
            sortFilter.addEventListener('change', filterArticles);
            
            // ãƒªãƒ•ãƒ¬ãƒƒã‚·ãƒ¥ãƒœã‚¿ãƒ³
            const refreshButton = document.getElementById('refresh-button');
            refreshButton.addEventListener('click', () => {
                location.reload();
            });
            
            // ãƒ†ãƒ¼ãƒãƒˆã‚°ãƒ«
            const themeToggle = document.getElementById('theme-toggle');
            themeToggle.addEventListener('click', toggleTheme);
            
            // ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰ã‚·ãƒ§ãƒ¼ãƒˆã‚«ãƒƒãƒˆ
            document.addEventListener('keydown', (e) => {
                if ((e.ctrlKey || e.metaKey) && e.key === 'k') {
                    e.preventDefault();
                    searchInput.focus();
                }
            });
        }
        
        // è¨˜äº‹ãƒ•ã‚£ãƒ«ã‚¿ãƒªãƒ³ã‚°
        function filterArticles() {
            const searchTerm = document.getElementById('search-input').value.toLowerCase();
            const sourceFilter = document.getElementById('source-filter').value;
            const sortFilter = document.getElementById('sort-filter').value;
            
            filteredArticles = articlesData.filter(article => {
                const matchesSearch = !searchTerm || 
                    article.title.toLowerCase().includes(searchTerm) || 
                    article.summary.toLowerCase().includes(searchTerm);
                
                const matchesSource = !sourceFilter || article.source === sourceFilter;
                
                return matchesSearch && matchesSource;
            });
            
            // ã‚½ãƒ¼ãƒˆ
            if (sortFilter === 'date-desc') {
                filteredArticles.sort((a, b) => new Date(b.published_jst) - new Date(a.published_jst));
            } else if (sortFilter === 'date-asc') {
                filteredArticles.sort((a, b) => new Date(a.published_jst) - new Date(b.published_jst));
            } else if (sortFilter === 'source') {
                filteredArticles.sort((a, b) => a.source.localeCompare(b.source));
            }
            
            displayArticles();
        }
        
        // ãƒ†ãƒ¼ãƒåˆ‡ã‚Šæ›¿ãˆ
        function toggleTheme() {
            const html = document.documentElement;
            const themeToggle = document.getElementById('theme-toggle');
            
            if (html.getAttribute('data-theme') === 'dark') {
                html.setAttribute('data-theme', 'light');
                themeToggle.textContent = 'ğŸŒ™';
            } else {
                html.setAttribute('data-theme', 'dark');
                themeToggle.textContent = 'â˜€ï¸';
            }
        }
        
        // ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿æ™‚ã«ãƒ‡ãƒ¼ã‚¿èª­ã¿è¾¼ã¿é–‹å§‹
        document.addEventListener('DOMContentLoaded', loadArticlesData);
    </script>
    <script src="assets/js/app.js"></script>
</body>
</html>